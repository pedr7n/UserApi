{"version":3,"file":"CaseInsensitiveKeysMap.js","sourceRoot":"","sources":["../../../src/Primitives/CaseInsensitiveKeysMap.ts"],"names":[],"mappings":"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","sourcesContent":["import { TypeUtil } from \"../Utility/TypeUtil.js\";\r\nimport { CaseInsensitiveKeysStore } from \"./CaseInsensitiveKeysStore.js\";\r\n\r\nfunction validateKey(key) {\r\n    if (TypeUtil.isNullOrUndefined(key)\r\n        || TypeUtil.isString(key)) {\r\n        return;\r\n    }\r\n\r\n    throw new Error(\"Key must be a string.\");\r\n}\r\n\r\nexport class CaseInsensitiveKeysMap {\r\n\r\n    public static create<TValue>(): Map<string, TValue> {\r\n        const result = new Map<string, TValue>();\r\n        const origSet = result.set;\r\n        const origGet = result.get;\r\n        const origHas = result.has;\r\n        const origDelete = result.delete;\r\n\r\n        const originalKeysStore = new CaseInsensitiveKeysStore();\r\n\r\n        result[\"keysCaseSensitive\"] = false;\r\n        result.set = function (...args) {\r\n            const [ key, ...rest ] = args;\r\n            validateKey(key);\r\n            const lowerKey = originalKeysStore.setKey(key);\r\n            return origSet.call(result, lowerKey, ...rest);\r\n        };\r\n\r\n        result.get = function (...args) {\r\n            const [ key, ...rest ] = args;\r\n            const lowerKey = originalKeysStore.normalizeKey(key);\r\n            return origGet.call(result, lowerKey, ...rest);\r\n        };\r\n\r\n        result.has = function (...args) {\r\n            const [ key, ...rest ] = args;\r\n            const lowerKey = originalKeysStore.normalizeKey(key);\r\n            return origHas.call(result, lowerKey, ...rest);\r\n        };\r\n\r\n        result.delete = function (...args) {\r\n            const [ key, ...rest ] = args;\r\n            validateKey(key);\r\n            const lowerKey = originalKeysStore.deleteKey(key);\r\n            return origDelete.call(result, lowerKey, ...rest);\r\n        };\r\n\r\n        const origEntries = result.entries;\r\n        result.entries = function () {\r\n            return Array.from(origEntries.call(result) as Iterable<[string, TValue]>)\r\n                .reduce((reduced, next) => {\r\n                    const actualKey = originalKeysStore.getKey(next[0]);\r\n                    return [...reduced, [actualKey, next[1]]];\r\n                }, [])[Symbol.iterator]();\r\n        };\r\n\r\n        result[Symbol.iterator] = function () {\r\n            return Array.from(origEntries.call(result) as Iterable<[string, TValue]>)\r\n                .reduce((reduced, next) => {\r\n                    const actualKey = originalKeysStore.getKey(next[0]);\r\n                    return [...reduced, [actualKey, next[1]]];\r\n                }, [])[Symbol.iterator]();\r\n        };\r\n            \r\n        return result;\r\n    }\r\n}\r\n"]}