import { QueryToken } from "./QueryToken.js";
import { throwError } from "../../../Exceptions/index.js";
export class FieldsToFetchToken extends QueryToken {
    fieldsToFetch;
    projections;
    customFunction;
    sourceAlias;
    constructor(fieldsToFetch, projections, customFunction, sourceAlias) {
        super();
        this.fieldsToFetch = fieldsToFetch;
        this.projections = projections;
        this.customFunction = customFunction;
        this.sourceAlias = sourceAlias;
    }
    static create(fieldsToFetch, projections, customFunction, sourceAlias) {
        if (!fieldsToFetch || !fieldsToFetch.length) {
            throwError("InvalidArgumentException", "fieldToFetch cannot be null");
        }
        if (!customFunction && projections && projections.length !== fieldsToFetch.length) {
            throwError("InvalidArgumentException", "Length of projections must be the same as length of field to fetch");
        }
        return new FieldsToFetchToken(fieldsToFetch, projections, customFunction, sourceAlias);
    }
    writeTo(writer) {
        for (let i = 0; i < this.fieldsToFetch.length; i++) {
            const fieldToFetch = this.fieldsToFetch[i];
            if (i > 0) {
                writer.append(", ");
            }
            if (!fieldToFetch) {
                writer.append("null");
            }
            else {
                QueryToken.writeField(writer, fieldToFetch);
            }
            if (this.customFunction) {
                continue;
            }
            const projection = this.projections ? this.projections[i] : null;
            if (!projection || projection === fieldToFetch) {
                continue;
            }
            writer.append(" as ");
            writer.append(projection);
        }
    }
}
//# sourceMappingURL=FieldsToFetchToken.js.map